<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Codepoints</title>
		<style>
			/* Dark mode variables */
			:root {
				--bg-color: #ffffff;
				--text-color: #000000;
				--border-color: #e0e0e0;
				--cp-bg: #f5f5f5;
			}

			@media (prefers-color-scheme: dark) {
				:root {
					--bg-color: #1a1a1a;
					--text-color: #ffffff;
					--border-color: #404040;
					--cp-bg: #2a2a2a;
				}
			}

			/* Base page styling */
			body {
				background-color: var(--bg-color);
				color: var(--text-color);
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
				line-height: 1.6;
				margin: 0;
				padding: 2rem;
				transition: background-color 0.3s ease, color 0.3s ease;
			}

			h1 {
				text-align: center;
				margin-bottom: 2rem;
				font-weight: 300;
				font-size: 2.5rem;
			}

			/* Codepoint styling */
			.cp {
				display: inline-flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				margin: -1em 0.125em;
				padding: 0.05em 0.25em;
				background-color: var(--cp-bg);
				border: 1px solid var(--border-color);
				border-radius: 0.2em;
				vertical-align: baseline;
				transition: background-color 0.3s ease, border-color 0.3s ease;
			}

			.cp:hover {
				background-color: var(--border-color);
			}

			.char {
				font-size: 0.8em;
				font-weight: 500;
				text-align: center;
				line-height: 1;
			}

			.hex {
				font-family: 'Courier New', Monaco, monospace;
				font-size: 0.3em;
				color: var(--text-color);
				opacity: 0.6;
				text-align: center;
				/* letter-spacing: -0.1em; */
				text-transform: uppercase;
				line-height: 1;
			}
		</style>
	</head>
	<body>
		<h1>Unicode <span id="codepoints-in-heading"></span></h1>
		<p>
			The codepoints in the text <code id="text"></code> are <span id="codepoints"></span>. Lorem ipsum dolor sit
			amet consectetur adipisicing elit. Maxime natus debitis nisi quod. Corporis consequuntur, aut quos
			voluptates magni iure tenetur incidunt sunt facilis amet corrupti. Ducimus iusto reiciendis quia!
		</p>
		<p>
			Lorem ipsum dolor sit amet consectetur adipisicing elit. Maxime natus debitis nisi quod. Corporis
			consequuntur, aut quos voluptates magni iure tenetur incidunt sunt facilis amet corrupti. Ducimus iusto
			reiciendis quia!
		</p>
		<script type="module">
			const input = '\tHello, world!\r\n'
			document.getElementById('text').textContent = JSON.stringify(input)
			const container = document.getElementById('codepoints')

			// Codepoints

			for (const char of 'Codepoints') {
				const cp = char.codePointAt(0)
				document.getElementById('codepoints-in-heading').innerHTML += render(cp)
			}

			for (const char of input) {
				const cp = char.codePointAt(0)
				container.innerHTML += render(cp)
			}

			function render(cp) {
				const char = String.fromCodePoint(cp)
				return `<span class="cp">
					<span class="char">${escapeHtml(visualize(char))}</span>
					<span class="hex">U+${char.codePointAt(0).toString(16).padStart(4, '0')}</span>
				</span>`
			}

			function visualize(char) {
				return char.replaceAll(
					/[\x00-\x20]/g,
					(m) => String.fromCodePoint(m.codePointAt(0) + 0x2400),
				)
			}

			function escapeHtml(text) {
				const map = {
					'&': '&amp;',
					'<': '&lt;',
					'>': '&gt;',
					'"': '&quot;',
					"'": '&#39;',
				}
				return text.replace(/[&<>"']/g, function (m) {
					return map[m]
				})
			}
		</script>
	</body>
</html>
